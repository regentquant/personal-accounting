export type Language = "en" | "zh";
export type Currency = "CNY" | "USD";

export const translations = {
  en: {
    // Auth
    "auth.signup": "Create account",
    "auth.login": "Sign in",
    "auth.logout": "Sign out",
    "auth.email": "Email",
    "auth.password": "Password",
    "auth.name": "Full Name",
    "auth.confirmEmail": "Check your email",
    "auth.emailSent": "We've sent a confirmation link to",
    "auth.backToLogin": "Back to login",
    "auth.googleSignUp": "Continue with Google",
    "auth.googleSignIn": "Continue with Google",
    "auth.emailSignUp": "or sign up with email",
    "auth.emailSignIn": "or sign in with email",
    "auth.createAccount": "Create account",
    "auth.creating": "Creating account...",
    "auth.signingIn": "Signing in...",
    "auth.alreadyHaveAccount": "Already have an account?",
    "auth.noAccount": "Don't have an account?",
    "auth.terms": "By creating an account, you agree to our Terms of Service and Privacy Policy",
    
    // Language & Currency
    "lang.en": "English",
    "lang.zh": "中文",
    "currency.cny": "Chinese Yuan (¥)",
    "currency.usd": "US Dollar ($)",
    "select.language": "Select Language",
    "select.currency": "Select Currency",
    
    // Dashboard
    "dashboard.greeting.morning": "Good morning",
    "dashboard.greeting.afternoon": "Good afternoon",
    "dashboard.greeting.evening": "Good evening",
    "dashboard.friend": "friend",
    "dashboard.overview": "Here's your financial overview for",
    "dashboard.totalBalance": "Total Balance",
    "dashboard.personalEquity": "Personal Equity",
    "dashboard.acrossAllAccounts": "Across all accounts",
    "dashboard.acrossPersonalAccounts": "Across personal accounts",
    "dashboard.totalAssets": "Total Assets",
    "dashboard.total": "Total",
    "dashboard.monthlyIncome": "Monthly Income",
    "dashboard.monthlyExpenses": "Monthly Expenses",
    "dashboard.vsLastMonth": "vs last month",
    "dashboard.samePeriodChange": "vs same period last month",
    "dashboard.equity.allTime": "All Time",
    "dashboard.equity.monthly": "Monthly",
    "dashboard.equity.allTimeBalance": "Personal Equity",
    "dashboard.equity.monthlyChange": "Personal Equity (Monthly)",
    "dashboard.equity.currentMonth": "Current month change",
    "chart.spendingTrends": "Spending Trends",
    "chart.categoryBreakdown": "Category Breakdown",
    "chart.expenseBreakdown": "Expense Breakdown",
    "chart.incomeBreakdown": "Income Breakdown",
    "chart.income": "Income",
    "chart.expense": "Expense",
    "chart.net": "Net",
    "chart.total": "Total",
    "chart.noExpenses": "No expenses this month",
    "chart.noIncome": "No income this month",
    
    // Accounts
    "accounts.title": "Accounts",
    "accounts.subtitle": "Click an account to view its income and expense details",
    "accounts.add": "Add",
    "accounts.viewAll": "View All",
    "accounts.noAccounts": "No accounts yet",
    "accounts.addFirst": "Add Your First Account",
    "accounts.reset": "Reset Accounts",
    "accounts.resetConfirm": "Reset all accounts to defaults?",
    "accounts.resetWarning": "This will delete ALL your accounts and restore default accounts. This action cannot be undone. Continue?",
    "accounts.confirmReset": "Confirm Reset",
    "accounts.resetting": "Resetting...",
    "accounts.excludedTooltip": "This account is excluded from your Personal Equity.",
    
    // Account Modal
    "account.new": "New Account",
    "account.edit": "Edit Account",
    "account.name": "Account Name",
    "account.icon": "Icon",
    "account.color": "Color",
    "account.initialBalance": "Initial Balance (optional)",
    "account.preview": "Preview",
    "account.create": "Create Account",
    "account.update": "Update Account",
    "account.creating": "Creating...",
    "account.updating": "Updating...",
    "account.deleteConfirm": "Are you sure you want to delete this account? This action cannot be undone.",
    "account.cannotDelete": "Cannot delete account with existing transactions",
    "account.excludeFromEquity": "Exclude from Personal Equity",
    "account.excludeFromEquityDesc": "Transactions will show in Spending Trends but won't affect Personal Equity totals or charts.",
    "account.excludeFromEquityWarning": "This account will be excluded from Personal Equity calculations.",
    "account.external": "External",
    
    // Transactions
    "transaction.new": "New Transaction",
    "transaction.edit": "Edit Transaction",
    "transaction.amount": "Amount",
    "transaction.category": "Category",
    "transaction.account": "Account",
    "transaction.date": "Date",
    "transaction.note": "Note (optional)",
    "transaction.notePlaceholder": "Add a note...",
    "transaction.expense": "Expense",
    "transaction.income": "Income",
    "transaction.add": "Add Transaction",
    "transaction.save": "Save",
    "transaction.saving": "Saving...",
    "transaction.update": "Update",
    "transaction.updating": "Updating...",
    "transaction.delete": "Delete",
    "transaction.search": "Search transactions...",
    "transaction.filter": "Filter",
    "transaction.filterAll": "All",
    "transaction.filterIncome": "Income",
    "transaction.filterExpense": "Expense",
    "transaction.noTransactions": "No transactions yet",
    "transaction.history": "Recent Transactions",
    "transaction.tryAdjusting": "Try adjusting your search or filters",
    "transaction.addFirst": "Add your first transaction to get started",
    "transaction.continuousEntry": "Continuous Entry",
    "transaction.addContinue": "Add & Continue",
    "transaction.saved": "Transaction Saved!",
    "transaction.calculatorHint": "Tap to open calculator (supports +, -, ×, ÷)",
    
    // Categories
    "category.food": "Food & Dining",
    "category.transport": "Transport",
    "category.shopping": "Shopping",
    "category.entertainment": "Entertainment",
    "category.bills": "Bills",
    "category.health": "Health",
    "category.education": "Education",
    "category.other": "Other",
    "category.productivity": "Productivity",
    "category.utilities": "Utilities",
    "category.travel": "Travel",
    "category.salary": "Salary",
    "category.bonus": "Bonus",
    "category.investment": "Investment",
    "category.gift": "Gift",
    "category.freelance": "Freelance",
    
    // Common
    "common.cancel": "Cancel",
    "common.close": "Close",
    "common.save": "Save",
    "common.delete": "Delete",
    "common.edit": "Edit",
    "common.loading": "Loading...",
    "common.error": "An error occurred",
    "common.success": "Success",
    
    // Footer
    "footer.madeWith": "Made with",
    "footer.tagline": "by Fika · Take a break, enjoy your finances",
    
    // Settings
    "settings.title": "Settings",
    "settings.userInfo": "User Information",
    "settings.updateNameError": "Failed to update name",
    "settings.language": "Language",
    "settings.currency": "Currency",
    "settings.preferredCurrency": "Preferred Currency",
    "settings.currencyLocked": "Set during signup (cannot be changed)",
    "settings.export": "Export Transactions",
    "settings.exportData": "Export Data",
    "settings.exportAll": "Export All Transactions",
    "settings.exportSuccess": "Transactions exported successfully",
    "settings.exportError": "Failed to export transactions",
    "settings.dataManagement": "Data Management",
    "settings.import": "Batch Import",
    "settings.importData": "Import Data",
    "settings.importFile": "Import from File",
    "settings.importPlaceholder": "Select .csv file to import",
    "settings.importSuccess": "Transactions imported successfully",
    "settings.importError": "Failed to import transactions",
    "settings.importInvalidFormat": "Invalid file format",
    "settings.importNoTransactions": "No transactions found in file",
    "settings.importPreview": "Import Preview",
    "settings.downloadExample": "Download Example File",
    "settings.importPreviewSummary": "{total} rows parsed — {valid} ready, {invalid} invalid",
    "settings.importConfirm": "Confirm",
    "settings.importWillCreateAccounts": "{count} account(s) will be created automatically",
    "settings.autoCreateAccountsOn": "Auto-create missing accounts: ON",
    "settings.autoCreateAccountsOff": "Auto-create missing accounts: OFF",

    // Help & Manual
    "help.title": "Help & Guide",
    "help.gettingStarted": "Getting Started",
    "help.managingAccounts": "Managing Your Accounts",
    "help.recordingTransactions": "Recording Transactions",
    "help.dashboardMetrics": "Understanding Dashboard Metrics",
    "help.subscriptions": "Tracking Subscriptions",
    "help.charts": "Charts & Analytics",
    "help.settings": "Settings & Preferences",
    "help.importExport": "Importing & Exporting Data",
    "help.faq": "Common Questions",

    // Personal Equity
    "equity.title": "Personal Equity Trend",
    "equity.income": "Income",
    "equity.expense": "Expense",
    "equity.net": "Net",
    "equity.dailyNet": "Daily Net",
    "equity.periodIncome": "Period Income",
    "equity.periodExpense": "Period Expense",
    "equity.netChange": "Net Change",
    "equity.personalOnly": "Personal Only",
    "equity.excludedAccountTitle": "Excluded Account Selected",
    "equity.excludedAccountDesc": "This account is excluded from Personal Equity calculations. Select a personal account to view the equity trend.",
    "equity.footerNote": "Only includes transactions from personal accounts (excluded accounts are not counted).",

    // Subscriptions
    "subscriptions.title": "Subscriptions",
    "subscriptions.active": "active",
    "subscriptions.annualTotal": "Annual Total",
    "subscriptions.monthlyAvg": "Monthly Average",
    "subscriptions.dueToday": "Due today",
    "subscriptions.dueTomorrow": "Due tomorrow",
    "subscriptions.overdue": "Overdue",
    "subscriptions.days": "days",
    "subscriptions.viewAll": "View all",
    "subscriptions.add": "Add Subscription",
    "subscriptions.noSubscriptions": "No subscriptions yet",
    "subscriptions.addFirst": "Add your first subscription",

    // Subscription Modal
    "subscription.new": "New Subscription",
    "subscription.edit": "Edit Subscription",
    "subscription.serviceName": "Service Name",
    "subscription.serviceNamePlaceholder": "e.g., Netflix, Spotify",
    "subscription.cost": "Cost",
    "subscription.billingCycle": "Billing Cycle",
    "subscription.monthly": "Monthly",
    "subscription.annual": "Annual",
    "subscription.nextPayment": "Next Payment Date",
    "subscription.icon": "Icon",
    "subscription.color": "Color",
    "subscription.note": "Note (optional)",
    "subscription.active": "Active",
    "subscription.create": "Add Subscription",
    "subscription.creating": "Adding...",
    "subscription.update": "Update",
    "subscription.updating": "Updating...",
    "subscription.delete": "Delete",
    "subscription.deleteConfirm": "Delete this subscription?",
  },
  zh: {
    // Auth
    "auth.signup": "创建账户",
    "auth.login": "登录",
    "auth.logout": "登出",
    "auth.email": "邮箱",
    "auth.password": "密码",
    "auth.name": "姓名",
    "auth.confirmEmail": "请检查您的邮箱",
    "auth.emailSent": "我们已向以下地址发送确认链接",
    "auth.backToLogin": "返回登录",
    "auth.googleSignUp": "使用 Google 继续",
    "auth.googleSignIn": "使用 Google 继续",
    "auth.emailSignUp": "或使用邮箱注册",
    "auth.emailSignIn": "或使用邮箱登录",
    "auth.createAccount": "创建账户",
    "auth.creating": "正在创建账户...",
    "auth.signingIn": "正在登录...",
    "auth.alreadyHaveAccount": "已有账户？",
    "auth.noAccount": "还没有账户？",
    "auth.terms": "创建账户即表示您同意我们的服务条款和隐私政策",
    
    // Language & Currency
    "lang.en": "English",
    "lang.zh": "中文",
    "currency.cny": "人民币 (¥)",
    "currency.usd": "美元 ($)",
    "select.language": "选择语言",
    "select.currency": "选择货币",
    
    // Dashboard
    "dashboard.greeting.morning": "早上好",
    "dashboard.greeting.afternoon": "下午好",
    "dashboard.greeting.evening": "晚上好",
    "dashboard.friend": "朋友",
    "dashboard.overview": "这是您本月的财务概览",
    "dashboard.totalBalance": "总余额",
    "dashboard.personalEquity": "个人净资产",
    "dashboard.acrossAllAccounts": "所有账户",
    "dashboard.acrossPersonalAccounts": "个人账户",
    "dashboard.totalAssets": "总资产",
    "dashboard.total": "总计",
    "dashboard.monthlyIncome": "本月收入",
    "dashboard.monthlyExpenses": "本月支出",
    "dashboard.vsLastMonth": "对比上月",
    "dashboard.samePeriodChange": "同期变化",
    "dashboard.equity.allTime": "累计",
    "dashboard.equity.monthly": "本月",
    "dashboard.equity.allTimeBalance": "个人净资产",
    "dashboard.equity.monthlyChange": "个人净资产（本月）",
    "dashboard.equity.currentMonth": "本月变化",
    "chart.spendingTrends": "支出趋势",
    "chart.categoryBreakdown": "分类明细",
    "chart.expenseBreakdown": "支出明细",
    "chart.incomeBreakdown": "收入明细",
    "chart.income": "收入",
    "chart.expense": "支出",
    "chart.net": "净额",
    "chart.total": "总计",
    "chart.noExpenses": "本月无支出",
    "chart.noIncome": "本月无收入",
    
    // Accounts
    "accounts.title": "账户",
    "accounts.subtitle": "点击账户可查看其收入和支出详情",
    "accounts.add": "添加",
    "accounts.viewAll": "查看全部",
    "accounts.noAccounts": "还没有账户",
    "accounts.addFirst": "添加您的第一个账户",
    "accounts.reset": "重置账户",
    "accounts.resetConfirm": "重置所有账户为默认值？",
    "accounts.resetWarning": "这将删除您的所有账户并恢复默认账户。此操作无法撤销。继续吗？",
    "accounts.confirmReset": "确认重置",
    "accounts.resetting": "正在重置...",
    "accounts.excludedTooltip": "此账户已从您的个人净资产中排除。",
    
    // Account Modal
    "account.new": "新建账户",
    "account.edit": "编辑账户",
    "account.name": "账户名称",
    "account.icon": "图标",
    "account.color": "颜色",
    "account.initialBalance": "初始余额（可选）",
    "account.preview": "预览",
    "account.create": "创建账户",
    "account.update": "更新账户",
    "account.creating": "正在创建...",
    "account.updating": "正在更新...",
    "account.deleteConfirm": "确定要删除此账户吗？此操作无法撤销。",
    "account.cannotDelete": "无法删除有交易记录的账户",
    "account.excludeFromEquity": "排除在个人净资产外",
    "account.excludeFromEquityDesc": "交易将显示在支出趋势中，但不会影响个人净资产总额和图表。",
    "account.excludeFromEquityWarning": "此账户将被排除在个人净资产计算之外。",
    "account.external": "外部",
    
    // Transactions
    "transaction.new": "新建交易",
    "transaction.edit": "编辑交易",
    "transaction.amount": "金额",
    "transaction.category": "分类",
    "transaction.account": "账户",
    "transaction.date": "日期",
    "transaction.note": "备注（可选）",
    "transaction.notePlaceholder": "添加备注...",
    "transaction.expense": "支出",
    "transaction.income": "收入",
    "transaction.add": "添加交易",
    "transaction.save": "保存",
    "transaction.saving": "正在保存...",
    "transaction.update": "更新",
    "transaction.updating": "正在更新...",
    "transaction.delete": "删除",
    "transaction.search": "搜索交易...",
    "transaction.filter": "筛选",
    "transaction.filterAll": "全部",
    "transaction.filterIncome": "收入",
    "transaction.filterExpense": "支出",
    "transaction.noTransactions": "还没有交易记录",
    "transaction.history": "最近交易",
    "transaction.tryAdjusting": "尝试调整搜索或筛选条件",
    "transaction.addFirst": "添加您的第一笔交易",
    "transaction.continuousEntry": "连续记账",
    "transaction.addContinue": "添加并继续",
    "transaction.saved": "交易已保存！",
    "transaction.calculatorHint": "点击打开计算器（支持 +、-、×、÷）",
    
    // Categories (keeping English for now as they're probably fine)
    "category.food": "餐饮",
    "category.transport": "交通",
    "category.shopping": "购物",
    "category.entertainment": "娱乐",
    "category.bills": "账单",
    "category.health": "健康",
    "category.education": "教育",
    "category.other": "其他",
    "category.productivity": "生产力",
    "category.utilities": "公用事业",
    "category.travel": "旅行",
    "category.salary": "工资",
    "category.bonus": "奖金",
    "category.investment": "投资",
    "category.gift": "礼品",
    "category.freelance": "自由职业",
    
    // Common
    "common.cancel": "取消",
    "common.close": "关闭",
    "common.save": "保存",
    "common.delete": "删除",
    "common.edit": "编辑",
    "common.loading": "加载中...",
    "common.error": "发生错误",
    "common.success": "成功",
    
    // Footer
    "footer.madeWith": "用",
    "footer.tagline": "制作 · 休息一下，享受您的财务生活",
    
    // Settings
    "settings.title": "设置",
    "settings.userInfo": "用户信息",
    "settings.updateNameError": "更新名称失败",
    "settings.language": "语言",
    "settings.currency": "货币",
    "settings.preferredCurrency": "首选货币",
    "settings.currencyLocked": "注册时设置（无法更改）",
    "settings.export": "导出交易",
    "settings.exportData": "导出数据",
    "settings.exportAll": "导出所有交易",
    "settings.exportSuccess": "交易导出成功",
    "settings.exportError": "导出交易失败",
    "settings.dataManagement": "数据管理",
    "settings.import": "批量导入",
    "settings.importData": "导入数据",
    "settings.importFile": "从文件导入",
    "settings.importPlaceholder": "选择 .csv 文件导入",
    "settings.importSuccess": "交易导入成功",
    "settings.importError": "导入交易失败",
    "settings.importInvalidFormat": "文件格式无效",
    "settings.importNoTransactions": "文件中未找到交易",
    "settings.importPreview": "导入预览",
    "settings.importPreviewSummary": "共 {total} 行 — {valid} 行可导入，{invalid} 行无效",
    "settings.downloadExample": "下载示例文件",
    "settings.importConfirm": "确认",
    "settings.importWillCreateAccounts": "将自动创建 {count} 个账户",
    "settings.autoCreateAccountsOn": "自动创建缺失账户：开",
    "settings.autoCreateAccountsOff": "自动创建缺失账户：关",

    // Help & Manual
    "help.title": "帮助与指南",
    "help.gettingStarted": "开始使用",
    "help.managingAccounts": "管理账户",
    "help.recordingTransactions": "记录交易",
    "help.dashboardMetrics": "了解仪表盘指标",
    "help.subscriptions": "订阅追踪",
    "help.charts": "图表与分析",
    "help.settings": "设置与偏好",
    "help.importExport": "导入与导出数据",
    "help.faq": "常见问题",

    // Personal Equity
    "equity.title": "个人净资产趋势",
    "equity.income": "收入",
    "equity.expense": "支出",
    "equity.net": "净额",
    "equity.dailyNet": "每日净额",
    "equity.periodIncome": "期间收入",
    "equity.periodExpense": "期间支出",
    "equity.netChange": "净变化",
    "equity.personalOnly": "仅个人",
    "equity.excludedAccountTitle": "已选择排除账户",
    "equity.excludedAccountDesc": "此账户已从个人净资产计算中排除。请选择个人账户以查看净资产趋势。",
    "equity.footerNote": "仅包含个人账户的交易（排除的账户不计入）。",

    // Subscriptions
    "subscriptions.title": "订阅",
    "subscriptions.active": "个有效",
    "subscriptions.annualTotal": "年度总计",
    "subscriptions.monthlyAvg": "月均",
    "subscriptions.dueToday": "今天到期",
    "subscriptions.dueTomorrow": "明天到期",
    "subscriptions.overdue": "已逾期",
    "subscriptions.days": "天",
    "subscriptions.viewAll": "查看全部",
    "subscriptions.add": "添加订阅",
    "subscriptions.noSubscriptions": "还没有订阅",
    "subscriptions.addFirst": "添加您的第一个订阅",

    // Subscription Modal
    "subscription.new": "新建订阅",
    "subscription.edit": "编辑订阅",
    "subscription.serviceName": "服务名称",
    "subscription.serviceNamePlaceholder": "如：Netflix、Spotify",
    "subscription.cost": "费用",
    "subscription.billingCycle": "计费周期",
    "subscription.monthly": "月付",
    "subscription.annual": "年付",
    "subscription.nextPayment": "下次付款日期",
    "subscription.icon": "图标",
    "subscription.color": "颜色",
    "subscription.note": "备注（可选）",
    "subscription.active": "已启用",
    "subscription.create": "添加订阅",
    "subscription.creating": "正在添加...",
    "subscription.update": "更新",
    "subscription.updating": "正在更新...",
    "subscription.delete": "删除",
    "subscription.deleteConfirm": "删除此订阅？",
  },
} as const;

export function getTranslation(key: string, lang: Language): string {
  // Access flat keys directly since translations use flat key structure
  const langTranslations = translations[lang] as Record<string, string>;
  return langTranslations[key] || key;
}

// Translate category names (categories are stored in English in DB)
export function translateCategoryName(categoryName: string, lang: Language): string {
  // Map English category names to translation keys
  const categoryMap: Record<string, string> = {
    "Food": "category.food",
    "Food & Dining": "category.food",
    "Transport": "category.transport",
    "Shopping": "category.shopping",
    "Entertainment": "category.entertainment",
    "Bills": "category.bills",
    "Utilities": "category.utilities",
    "Health": "category.health",
    "Education": "category.education",
    "Other": "category.other",
    "Productivity": "category.productivity",
    "Travel": "category.travel",
    "Salary": "category.salary",
    "Bonus": "category.bonus",
    "Investment": "category.investment",
    "Gift": "category.gift",
    "Freelance": "category.freelance",
  };
  
  const translationKey = categoryMap[categoryName];
  if (translationKey) {
    return getTranslation(translationKey, lang);
  }
  
  // If no translation found, return original name
  return categoryName;
}

export function formatCurrency(amount: number, currency: Currency): string {
  const formatter = new Intl.NumberFormat(
    currency === "CNY" ? "zh-CN" : "en-US",
    {
      style: "currency",
      currency,
      minimumFractionDigits: 2,
      maximumFractionDigits: 2,
    }
  );
  
  return formatter.format(amount);
}

